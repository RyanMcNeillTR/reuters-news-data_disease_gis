---
title: "Adding data - Allison's work"
output:
  github_document:
    toc: true
---

Set working directory for Allison's Windows laptop

```{r}

setwd("C:/Users/0146156/Documents/mb_checks/reuters-news-data_disease_gis")

```

Load libraries

```{r}

library(tidyverse)
library(sf)

```

Get GADM data. 

```{r}

st_layers("./input_data/Bangladesh/gadm/gadm36_BGD_gpkg/gadm36_BGD.gpkg")

bgd_gadm_2 <- st_read("./input_data/Bangladesh/gadm/gadm36_BGD_gpkg/gadm36_BGD.gpkg",
                      layer = "gadm36_BGD_2") %>%
              janitor::clean_names()

bgd_gadm_3 <- st_read("./input_data/Bangladesh/gadm/gadm36_BGD_gpkg/gadm36_BGD.gpkg",
                      layer = "gadm36_BGD_3") %>%
              janitor::clean_names()

bgd_gadm_4 <- st_read("./input_data/Bangladesh/gadm/gadm36_BGD_gpkg/gadm36_BGD.gpkg",
                      layer="gadm36_BGD_4") %>%
              janitor::clean_names()

st_layers("./input_data/India/gadm36_IND.gpkg")

ind_gadm_3 <- st_read("./input_data/India/gadm36_IND.gpkg",
                      layer = "gadm36_IND_3") %>%
              janitor::clean_names()

```

Get other spatial data.

```{r}

st_layers("./input_data/India/Kerala")

ind_taluks <- st_read("./input_data/India/Kerala", layer = "taluk") %>%
  rename(geom = geometry, oid = OID_, taluk = TALUK, state = STATE, district = DISTRICT)

st_layers("C:/Users/0146156/Documents/mb_checks/stanford_level_3")

phl_level_3 <- st_read("C:/Users/0146156/Documents/mb_checks/stanford_level_3")

```

Setting up function that returns variables based on single GADM polygon.

```{r}

grab_polygon <-function(geom, id) {
  geom %>% select(poly_geom = geom) %>% 
           mutate(point_geom = st_centroid(poly_geom),
                  precision = "centroid",
                  reuters_id = id,
                  country_iso = "BGD")
}

```


#bgd_90



#bgd_98

This adds a second location to the incident first described in bgd_41, see notes there.

```{r}

bgd_98 <- bgd_gadm_3 %>% filter(str_detect(name_3, "Khetlal")) %>%
  grab_polygon(98)
  
```


#phl_99

This adds a second location to the incident described in phl_22, see notes there. 

```{r}

phl_99 <- phl_level_3 %>% filter(str_detect(name_3, "Midtungok")) %>%
  rename(geom = geometry) %>%
  grab_polygon(99) %>% 
  mutate(country_iso = "PHL")

```

#bgd_101 / bgd_102 / bgd_103 / bgd_104

All three of these are drawn from an archived WHO table which has been incorporated into for example Deka (CDC's) data but not Metabiota's database. One academic paper strongly suggests they are all connected to the well documented 2012 Joypurhat outbreak but it is not written by local experts and may be a simple misinterpretation of the WHO data: "The final outbreak was in 2012 in Joypurhat, Rajshshi, Natore, and Rajbari with a fatality rate of 83% (n=12)." (paper here)[https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6415930/]

Sought more details from IECDR website, ProMED, Daily STar, BDNews, FluTrackers, Factiva and general Google searches.

Rajshahi:

A little concerned this is a coding error because one of the Joypurhat cases apparently died at a hospital in Rajshahi. See ProMED: "Of the 5 deaths, 2 are from Khetlal and the others from the municipality. They died in Ziaur Rahman Medical College Hospital in Bogra and Rajshahi Medical College Hospital. On 21 Jan [2012], a 5-member IECDR expert team went to Bogra and Rajshahi to collect blood and other samples." (source)[https://promedmail.org/promed-post/?id=1022056]

There is a slightly better document Rajshani case for 2013, which we coded under bgd_34. 

Then again it is clearly included in the WHO's reporting table, archived online (here)[http://web.archive.org/web/20190922101016/http://www.searo.who.int/entity/emerging_diseases/links/nipah_virus_outbreaks_sear/en/]

Natore, Rajbari, Gopalganj: 

No indication of a case there in other sources.

*** Not coding these

#bgd_105

This is a potential cause in Pataukhali district, pulled from an archived news story. After discussion with Deb, excluding because time from sap drinking to death seems too short.

"Source: The Daily Star, Staff Correspondent
Date: 10 February 2012
Nipah virus claimed the life of an SSC examinee at Patuakhali General Hospital yesterday. The victim,
Nargis Akhter, 16, daughter of Hasan Sikder of Gabua village under Patuakhali Sadar upazila, was
appearing in the ongoing SSC examinee from Gabua Janata High School. Family and hospital sources said
Nargis fell sick after having date juice at around 8:00am. She was taken to the hospital where she died at
around 1:30pm."
[Archived story](https://web.archive.org/web/20120412182445/http://saarc-sdmc.nic.in/pdf/saarc_news/news227.pdf)

#bgd_106

Viral sequence is listed as a primary case in a 7 year old male in Rayman et al 2021, [here](https://www.sciencedirect.com/science/article/pii/S1201971220322451#tbl0020). District is Kurigram and subdistrict Fulbari. 

IECDR's list of 2013 cases lists a 7 year old male who died in Kurigram that year.

*** Coding to Fulbari upazila, which in GADM is transliterated as 'Phulbari'

```{r}

bgd_105 <- bgd_gadm_3 %>% filter(str_detect(name_2, "Kurigram")) %>%
  filter(str_detect(name_3, "Phulbari")) %>%
  grab_polygon(105)


```




